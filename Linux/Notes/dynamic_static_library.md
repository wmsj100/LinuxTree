---
title: 动态库和静态库
date: 2020-04-08 11:49:58
modify: 
tags: [Notes]
categories: Linux
author: wmsj100
email: wmsj100@hotmail.com
---

# 动态库和静态库

## 库

- 库是写好的现有的，成熟的，可以复用的代码。
- 现实中每个程序都要依赖很多基础的底层库，不可能每个人的代码都从零开始，因此库的存在意义非同寻常。
- 本质上来说库是一种可执行的二进制形式，可以被操作系统载入内存执行。
- 库有俩种：静态库(.a/.lib)和动态库(.so/.dll)
- 所谓静态和动态是指链接

## 静态库

- 之所以称为静态库，是因为在链接阶段，会将汇编生成的目标文件.o与引用到的库一起链接打包到可执行文件中。因此对应的链接方式称为静态链接。
- 试想一下，静态库与汇编生成的目标文件一起链接为可执行文件，那么静态库必定跟.o文件格式相似。
- 其实一个静态库可以简单看成是一组目标文件(.o/.obj)集合，即很多目标文件经过压缩打包后形成一个文件。静态库特定总结：
	- 静态库对函数库的链接是放在编译时期完成的。
	- 程序在运行时期与函数库再无瓜葛，移植方便
	- 浪费空间和资源，因为所有相关的目标文件与牵涉到的函数库被链接合成一个可执行文件。

## 动态库

- 动态库的出现是为了解决静态库的空间浪费
- 另一个问题是静态库对程序的更新、部署和发布会带来麻烦。
- 如果静态库liba.lib更新了，所有使用它的应用程序都需要重新编译、发布给用户
- 动态库在程序编译时并不会被链接到目标代码中，而是在程序运行时才被载入。
- 不同的应用程序如果调用相同的库，那么在内存里只需要有一份该共享库的实例，规避了空间浪费的问题。
- 动态库在程序运行时才被载入，也解决了静态库对程序的更新、部署和发布会带来的麻烦。用户只需要更新动态库即可，增量更新。
- 动态库特定
	- 动态库把对一些库函数的链接载入推迟到程序运行时期。
	- 可以实现进程之间的资源共享
	- 将一些程序升级变成简单
	- 甚至可以真正做到链接载入完全由程序员在程序代码中控制
- 动态链接库，前缀是lib，后缀是.so

## 总结

- 静态库在程序编译时会被链接到目标代码中，程序运行时将不再需要该静态库，因此体积较大
- 动态库在程序编译时并不会被链接到目标代码中，而是在程序运行时才被载入，因此程序运行时还需要动态库存在，因此代码体积较小。
- 动态库的好处是，不同的应用程序如果调用相同的库，那么在内存中只需要有一份该共享库的实例。

## 参考

- [动态库和静态库区别](https://www.cnblogs.com/skynet/p/3372855.html)
