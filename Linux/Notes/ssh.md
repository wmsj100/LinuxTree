---
title: ssh
date: 2019-05-16 22:58:14 Thursday
modify: 2020-03-14 23:44:47 
tag: [ssh]
categories: Linux
author: wmsj100
mail: wmsj100@hotmail.com
---

# ssh

## 概述

- ssh是一种通讯协议，可以实现安全远程登陆

## 背景

- 传统的网络服务程序,如ftp/pop/telnet本质上都是不安全的,因为他们再网络上使用明文传送口令和数据,别有用心的人非常容易截获这些口令和数据
- 而且这些服务程序的安全验证方式也是有其弱点的,就是很容易受到中间人(man-in-the-middle)这种方式的攻击.
- 所谓中间人的攻击方式就是中间人冒充真正的服务器接受你传送给服务器的数据,然后再冒充你把数据传给真正的服务器,
- 服务器和你之间的数据被中间人这样一转手做了手脚之后,就会出现很严重的问题.
- 通过使用SSH,你可以把所有传输的数据进行加密,这样中间人这种攻击方式就不可能实现了,而且也能够防止DNS欺骗和IP欺骗.
- 使用SSH,还有一个好处就是传输的数据是经过压缩的,所以可以加快传输的速度.

## 原理

- 客户端把自己的公钥存放到服务器
- 客户端通过ssh连接服务器时先向服务器发出请求,请求用你的密钥进行安全验证.
- 服务器受到请求之后,现在该服务器上你的主目录下寻找你的公用密钥,然后把它和你发送过来的公钥进行比对.
- 如果俩个密钥一致,服务器就用公钥加密"质询",并把它发送给客户端软件.
- 客户端软件受到质询之后,可以用自己的私钥解密,再把它发送给服务器
- 服务器验证ok,就可以传输了.

## 用法

- `ssh-keygen -t rsa -C "wmsj100@hotmail"` 生成密钥
- `ssh-copy-id pi@192.168.1.103` 把客户端公钥发送给服务器，服务器会把公钥追加到服务端对应用户的`$HOME/.ssh/authorized_keys` 文件中
- 这样操作后就可以在客户端直接`ssh pi@192.168.1.103`登陆了，免密码操作

## ssh 保持连接

- 默认如果连接到服务器的ssh客户端如果长时间没有操作,服务器会自动断开,可以在本地配置来保持这种连接性
- `alias  ssh='ssh -o ServerAliveInterval=60'` 通过创建这样的快捷键来实现

## 配置文件

- `/etc/ssh/sshd_config` ssh的配置文件
- `ClientAliveInterval 60` 设置客户端60就接受一次来自服务端的请求保持连接激活状态

## 参考

- [ssh客户端](https://blog.csdn.net/m0_37822234/article/details/82494556)
- [ssh协议](https://baike.baidu.com/item/ssh/10407)
