---
title: TCP三次握手
date: 2020-03-14 14:13:19
modify: 
tags: [Notes]
categories: NetWork
author: wmsj100
email: wmsj100@hotmail.com
---

# TCP三次握手

## 概要

- TCP的三次握手是在建立连接之前都需要确认的动作
- 只有确认过3次握手动作才表示当前网络是可以通信的
- 这个过程类似通信
	- A: B你在不在
	- B: 我在,A你在不在
	- A: 我也在
	- 然后俩个人就可以进行通信了.

## 三次握手机制

- 数据包发送
	- 但客户端想要对服务器连接时,必须要送出一个要求连接的数据包,
	- 此时客户端必须随即取用一个大于1024的并且没有被使用的端口,来作为沟通接口
	- 然后在TCP的报头中,必须要带有SYN的主动连接(SYN=1),并且记下发送出连接数据包给服务器的序号(Sequence number=10001)
- 数据包接受和确认数据包传送
	- 当服务器接到这个数据包,并且确认要接受这个数据包后,就开始制作一个同时带有SYN=1,ACK=1的数据包
	- 其中那个AckNowledge的号码是要给Client端确认用的.所以该数字会比A步骤的面的`Sequence number`号码多一号(ack = 10001 + 1 = 10002)
	- 服务器也必须确认客户端可以接受我们的数据包才行,所以也会发送一个Sequence Number(seq=20001)给客户端
	- 然后等待客户端给我们服务器端的回应
- 回送确认数据包
	- 但客户端受到来自服务的的ACK数字(10002)就能确认之前那个数据包被正确接受了.
	- 客户端也同意与服务器建立连接时,就会再次发送一个确认数据包(ACK=1)给服务器,ack=20001+1=20002
- 取得最后确认
	- 若一切都顺利,在服务器接收到客户端发送的带有ACK=1且ack=20002序号的数据包后,就能够建立起这次连接了.

## 总结

- 因为网络是双向的,所以不论是服务器还是客户端都需要通过一次SYN与ACK来建立连接,所以总共会进行三次交谈.

## 参考

- [鸟哥的私房菜-网络篇]()
