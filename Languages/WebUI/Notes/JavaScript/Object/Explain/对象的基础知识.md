---
title: 对象的基础知识
date: 2016-06-08
tags: [Object]
categories: Dynamic
---

JS的所有数据都可以被视为对象。
对象就是若干无序的键值对。

对象的生成方式有3种：
- `var a = new Object()`;
- `var a = {}`;
- `var a = Object.create(null)`;当只有一个参数的时候等同于`var a = Object()`;
上面三行语句是等价的。一般来说，第一种采用大括号的写法比较简洁，第二种采用构造函数的写法清晰地表示了意图，第三种写法一般用在需要对象继承的场合。

对象的所有键名都是字符串，所以加不加引号都可以。

**JavaScript的保留字可以不加引号当作键名。**
```javascript
var obj = {
  for: 1,
  class: 2
};
```

对象的键值可以是任意类型，如果为函数，则把这个属性称为方法，它可以像函数那样调用。

对象的属性之间用逗号分隔，最后一个属性后面可以加逗号（trailing comma），也可以不加。

由于对象的方法就是函数，因此也有name属性。
```javascript
var a = {
            "p1": function(){},
            "p2": function w(){},
        }
a.p1.name;  //p1
a.p2.name;  //"w";
```
函数的`name`就是函数的标识符

### 对象的引用

如果不同的变量都指向同一个对象，那么这些变量都引用了同一个对象，如果通过其中一个变量修改了对象，那么这个修改会传递给所有的对象。

```javascript
    var a = {};
    var b = a;
    a.q = 1;
    b.w = 2;
    a;  //Object {q: 1, w: 2}
    b;  //Object {q: 1, w: 2}
    a = null;
    b;  //Object {q: 1, w: 2}
```

如果取消其中一个变量的引用，不会影响到其它变量。
对于简单类型的引用都是传值引用，即数值拷贝，复杂类型的引用都是指针的引用。

对象采用大括号表示，这导致了一个问题：如果行首是一个大括号，它到底是表达式还是语句？

{ foo: 1 }

JavaScript引擎读到上面这行代码，会发现可能有两种含义。第一种可能是，这是一个表达式，表示一个包含foo属性的对象；第二种可能是，这是一个语句，表示一个代码区块，里面有一个标签foo，指向表达式123。

为了避免这种歧义性，JavaScript规定，如果行首是大括号，一律解释为语句（即代码块）。如果要解释为表达式（即对象），必须在大括号前加上圆括号。

({ foo: 1})

这种差异在eval语句中反映得最明显。

eval('{foo: 1}') // 123
eval('({foo: 1})') // {foo: 123}

上面代码中，如果没有圆括号，eval将其理解为一个代码块；加上圆括号以后，就理解成一个对象。

`for in` -- 会遍历对象的所有的属性，包括自身拥有的和对象从原型链继承的属性。
通过添加`hasOwnProperty`可以判断属性是否在对象内部。

```javascript
    for(var key in b){
        if(b.hasOwnProperty(key)){
            console.log(key)
        }
    }
```
