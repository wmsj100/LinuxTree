---
title: 分布式系统概览
date: 2020-04-07 23:19:20
modify: 
tags: [Notes]
categories: OSS
author: wmsj100
email: wmsj100@hotmail.com
---

# 分布式系统概览

## 概要

- 分布式系统是一个古老而宽泛的话题，因大数据概念的兴起又重新焕发活力。
- 分布式系统也是一门理论模型与工程技法并重的学科内容。入门容易，深入难。
- 分布式系统大概包括三大部分:
	- 分布式存储系统
	- 分布式计算系统
	- 分布式管理系统
- 近十年来在这三个方向上，毫无疑问，Google都是开创者，甚至业内人士都说，这十年是外界追随谷歌技术的十年。
- 分布式系统的研究是一门由实际问题驱动的研究，而google则是最先面对这些实际问题的公司。

## 分布式存储系统

- 分布式存储系统是一个非常古老的话题，同时也是分布式系统里最难，最复杂，涉及面最广的问题，往细分，分布式存储大概可以分为四个子方向
	- 结构化存储
	- 非结构化存储
	- 半结构化存储
	- In-memory存储

### 结构化存储

- 结构化存储(structured storage systems)的历史非常古老，典型的场景就是事务处理系统或者关系型数据库(RDBMS).
- 传统的结构化存储都是从单机做起的，比如耳熟能详的mysql。
- 有句话说mysql的成长史就是互联网的成长史。
- 传统的结构化存储系统强调的是
	- 结构化数据(关系表)
	- 强一致性
	- 随机访问(索引，增删改查，SQL语言)
- 然而正是由于这些性质和限制，结构化存储系统的可扩展性通常都不是很好，这在一定程度上限制里结构化存储在大数据环境下的表现。
- 随着摩尔定律面临瓶颈，传统的单机关系型数据库系统面临着巨大的挑战。

### 非结构化存储

- 和结构化存储不同，非结构化存储强调的是高可扩展性，典型的系统就是分布式文件系统。
- 分布式文件系统也是一个古老的研究话题。
- 早期的分布式文件系统只是起到里网络磁盘的作用，其最大的问题就是不支持**容错**和错误恢复。
- Google在2003年SOSP上推出的GFS(google file system)则是作出里里程碑的一步，其开源实现对应为HDFS
- GFS的主要思想包括:
	- 用master来管理metadata.
	- 文件使用64MB的chunks来存储，并且在不同的server上保存多个副本。
	- 自动容错，自动错误恢复
- google涉及gfs最初的目的是为了存储海量的日志文件以及网页等文本信息，并且对其进行批量处理。
- 和结构化存储系统相比，虽然分布式文件系统的可扩展性、吞吐率都非常好，但是几乎无法支持随机访问(random access)操作，通常只能进行文件追加操作，而这些限制使得非结构化存储系统很难面对那些低延时，实时性较强的应用。

### 半结构化存储

- 半结构化存储的提出便是为了解决非结构化存储系统随机访问性能差的问题。
- 其中以NoSQL的发展势头尤为强烈。
- NoSQL系统既有分布式文件系统所具有的可扩展性，又有结构化存储系统的随机访问能力(随机update,read)系统在设计时通常选择简单键值进行存储，抛弃里传统RDBMS里复杂SQL查询以及ACID事务。
- 这样做可以换取系统最大的限度的可扩展性和灵活性。
- 在NoSQL比较有名的是google的bigtable, Amazon的Dynamo，以及开源界大名鼎鼎的HBase, Cassandra等。
- 通常这些NoSQL系统底层都是基于比较成熟的存储引擎，比如Bigtable就是基于LevelDB，底层数据结构采用LSM-Tree.

### In-memory存储

- 随着业务的并发越来越高，存储系统对低延迟的要求越来越高。同时由于摩尔定律以及内存价格不断下降，基于内存的存储系统也开始普及。
- In-memory存储顾名思义就是将数据存储在内存中，从而获得读写的高性能。比较有名的memcached, Redis.
- 这些基于k-v键值系统的主要目的是基于磁盘的存储系统做cache。
- 还有一些偏向于内存计算的系统，最近比较火的基于lineage技术的tachyon(Spark生态系统子项目)

### NewSQL

- 我们在介绍结构化存储时说到，单机RDBMS系统在可扩展性上面临着巨大的挑战，然而NoSQL不能很好的支持关系模型。
- 那是不是有一种系统能兼容RDBMS的特性，又能像NoSQL系统那样具有强大的可扩展性
- 2012年Google在OSDI上发表的Spanner，以及2013年在SIGMOD发表的F1，让业界第一次看到里关系模型和NoSQL在超大规模数据中心上融合的可能性。
- 不过由于这些系统都太过于黑科技里，没有大公司支持应该是做不出来的。
- 比如Spanner里用里原子钟这样的黑科技来解决时钟同步问题，打破光速传输的限制。
- 这里只能对google表示膜拜。

## 分布式计算系统

- 分布式计算和并行计算是一回事吗？
- 传统的并行计算要得是:投入更多机器，数据大小不变，计算速度更快。
- 分布式计算要求: 投入更多机器，能处理更大的数据。
- 换句话说二者的出发点从一开始就不同，一个强调high performance,一个强调scalability.
- 举例来说，MapReduce给业界带来的真正的思考是什么？其实是给我们普及里google这样级别的公司对真正意义的大数据的理解。
- 因为在04年论文出来之前，搞并行计算的人压根连容错的概念都没有。换句话说，分布式计算最为核心的部分就是容错，没有容错，分布式计算根本无从谈起。
- MapReduce要做成这个样子，(map+reduce)其实就是为了容错。
- 好好的计算为什么会出错呢？一方面，由于硬件老化，有可能会导致某台存储设备没有启动起来，某台机器的网卡坏了，甚至于计算运行过程中断电里，这些都是有可能的。
- 然而最平凡发生的错误是计算进程被杀掉。因为google的运行环境是共有集群，任何一个权限更高的进程都可能kill掉你的计算进程。
- 设想在一个拥有几千台机器的集群中运行，一个进程都不被kill掉的概率几乎为零。
- 

## 参考

- [分布式系统学习](https://www.cnblogs.com/xybaby/p/7787034.html)
- [分布式系统概论](https://www.zhihu.com/question/23645117)
