---
title: zipkin-build
date: 2020-06-24 17:46:35
modify: 
tags: [Summary]
categories: Docker
author: wmsj100
email: wmsj100@hotmail.com
---

# zipkin-build

## 概要

- 构建zipkin用了接近3天时间，最开始茫然，不知道去哪里找镜像。
- 开始以为在dockerhub上面查到版本就可以使用了，等到实际用的时候从才发现那是x86架构的，而且包本身的嵌套关系非常复杂，底层的依赖镜像都没有arm版本，需要自己手动编译。
- 在一个个解决问题的过程中逐渐开始了解了如何解决镜像构建问题，
- 对于谷歌的java和cc镜像因为无法获取，然后就想到了要使用替代镜像，昨天是想着用openjdk来使用，后来没有用，直接使用了构建镜像，这样做出来的镜像有1.5G左右，当时就意识到这样是不行的，
- 早上来了重新想着按照谷歌的cc镜像来自己制作一个镜像，开始是使用busybox，但因为没有软件安装方式，所以就放弃了，使用alpine镜像，因为这个镜像就是基于busybox的。
- 然后找到了给这个镜像安装glibc的方式就开始使用，拷贝最后的运行java的文件，手动在镜像测试是ok的。这样就解决了最终运行环境的镜像
- 在编译过程中最难的问题是zipkin-lengs的UI文件打包报错，尝试了很多方式，最后安装了make,g++等库，还有python和node和npm环境，总之把这个镜像搞的非常大，但虽然有很多报错，结果是打包成功的。
- 在制作这个镜像过程中对于Dockerfile的编写有了更加深入的了解，而且最终的运行环境还是自己构建的运行环境。这一点在昨天或者是前天我也不敢想自己会定制镜像出来。
- 去做了才意识到制作docker镜像是很容易的事情，只要把握好那几个命令就好。
- 这个镜像制作非常困难，但收获也非常多。

## 参考

