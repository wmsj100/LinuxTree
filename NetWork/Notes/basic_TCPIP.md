---
title: TCPIP协议
date: 2018-03-17 10:08:57 Sat
modify: 2018-03-17 10:08:57 Sat
tag: [net,tcp,ip]
categories: Network
author: wmsj100
mail: wmsj100@hotmail.com
---

# TCPIP
- TCP/IP Transmission Control Protocol/Internet Protocol 传输控制协议和网络协议的简称
- 将世界各地的计算机进行连接并且可以进行沟通
- tcpip 是传输控制协议和网络协议的简称。它定义了电子设备如何年入因特网以及数据如何在他们之间传输的标准。
- tcpip 不是一个协议，而是一个协议的通称，里面包括了IP 协议/ ICMP协议/ TCP 协议/ http协议/ ftp协议/ pop3协议 网络中的计算机都采用这套协议进行互联。

- OSI七层模型： 物理层/ 数据链路层/ 网络层/ 传输层/ 会话层/ 表示层/ 应用层
- TCP/IP四层模型： 网际接口层/ 网络层/ 传输层/ 应用层
	- 网际接口层： PPP/ Etherent
	- 网络层： IP/ ICMP/ ARP
	- 传输层： TCP/ UDP
	- 应用层： SMTP/ http/ DNS/ https / Telnet/ POP3/ SNMP/ FTP/ NFS

## IP地址
- 网络中的每一个节点都必须有一个独立的IP地址，有了IP地址，用户计算机就可以发现并访问网络中另外一台计算机
- ifconfig -a 查看自己的IP 地址 在 inet 字段 192.168.0.106
- IP是一个32bit的数字，分为4组
- IP用来发现和查找网络中的地址

## 域名
- 12位的IP地址很难记，域名是IP的别名，与IP相对应，并把这种对应关系存储在域名服务器系统DNS（Domain Name System）这样只需要记住域名就可以与指定计算机进行通信。
- ping www.github.com 可以查看是否可以访问，并且可以查看域名相对应的IP地址。

## MAC地址
- MAC（Media Access Control）或称为物理地址/ 硬件地址/ 用来定义互联网中硬件的位置。
- 在TCP/IP层次模型中，网络层管理IP地址，链路层则负责MAC地址，
- 每个网络位置会有一个专属于它的IP地址。
- 每个主机会有一个专属于它的MAC地址

### 总结
- 网络位置IP是定位网络资源的重要信息，通过域名或者IP来查找网络资源
- 一个网络可以有多个主机或者主集群提供请求服务，每个主机有自己的MAC地址
- 对于用户只能感知到IP或者域名
- 管理员会去关注MAC地址

## 端口号
- 不同程序通过端口号来互相通信。
- 如果IP地址是一个房子，那么端口号就是房子的门。
- 一个IP可以有2^16总共65536个端口，有专门的端口分配机构管理熟知的端口
- 服务器的默认程序都是通过人们熟知的端口号来识别的。
	- SSH 22
	- FTP 21
	- Telnet 23
	- SMTP 25
	- TFTP 69
	- HTTP 80
	- SNMP 161
	- Ping使用ICMP 无具体端口号

## 封装和分用
- 封装： 当应用程序发送数据时候，数据在协议层次当中从定向下通过每一层，每一层都会对数据增加一些头部或尾部信息，这些信息称之为协议数据单元（Protocao Data Unit, PDU),在指定的协议层上传送的数据单元，包含了该层的协议控制信息和用户信息。
	- 物理层（一层）PDU指数据位（Bit）
	- 数据链路层（二层）PDU指数据帧（Frame）
	- 网络层（三层）PDU指数据包（Packet）
	- 传输层（四层）PDU指数据段（Segment)
	- 第五层以上为（data）
- 当主机收到一个数据帧时，数据就从协议层底向上，通过每一层，检查并去掉每一层的报文首部或尾部，与封装过程正好相反。

# TCP 协议

- TCP和UDP处于同一层--运输层，
- TCP是TCP/IP系列协议中最复杂的部分。
- TCP提供可靠的数据传输服务，是面向连接的，在使用前需要先建立连接。通信结束后还需要断开连接。
- TCP连接是点对点的，一条TCP连接只能连接俩个端点
- TCP提供可靠传输，无差错/不丢失/不重复/按顺序
- TCP提供全双工通信，允许通信双方任何时候都能发送数据，因为TCP俩端都设有发送缓存和接收缓存。
- TCP是面向字节流。不知道传输的数据的含义，仅把数据看作一连串的字节序列。

## TCP可靠传输的实现
- TCP报文段长度可变，根据手发双方的缓存状态/网络状态而调整。
- 当TCP收到TCP连接的另一端的数据，它将发送一个确认。
- 当TCP发出一个段后，它启动一个定时器，等待目的端确认收到这个报文，如果不能及时收到就超时重发
- TCP将保持它首部和数据的校验和，如果通过校验和发现报文有差错，这个报文段将被丢弃，等待超市重发。
- TCP将数据按字节排序，报文段中有序号，以确保顺序的正确性。
- TCP还能提供流量的控制，防止较快主机致使较慢主机的缓冲区溢出。

## 超时重发
- TCP规定了，接收者收到数据报文后，需要回复一个确认报文段，以告知发送者数据已经收到，而发送者如果一段时间内没有收到确认报文段，便重复发送。

## 连续ARQ协议
- 超时重传机制很费时间，每发送一个数据都需要确认。
- 在实际引用中的确不是这样的，真实情况是，采用了流水传输：
	- 发送法可以连续发送多个报文段，连续发送的数据长度叫窗口，而不是每发完一段就停下来等待确认。
	- 接收方不必对收到的每个报文都做回复，而是采用累积确认的方式，接收者等待收到多个来连续的报文段后，只确认回复最后一个报文段，表示之前的数据已经收到。
- 这样传输效率就得到了提升。
