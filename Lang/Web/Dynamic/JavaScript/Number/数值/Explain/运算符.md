---
title: 运算符
date: 2016-06-09
tags: [Number]
categories: Dynamic
---

运算符是处理数据的基本方法，用现有的数据得到新数据。

### 加法运算符``+`

有俩种形式，加法和连接；具体规则如下：
1. 如果是对象，则先自动转换为原始类型的值，即先执行`valueOf`，如果结果还不是原始类型，则再通过`toString`方法。如果是Date类型会直接转换为字符串。
2. 如果有一个值是字符串，那么都转换为字符串，执行连接运算。
3. 否则俩个值都转换为数值，执行加法运算；

`x + ''` => `'x'`; 这个方法可以把数值转换为字符串。

加法运算符会将其它类型的值自动转换为字符串进行连接运算。

如果只有右边一个运算子，那么此时就是另一个运算符了--`数值运算符`；可以把字符串转换为数值。

重载-- 由于参数不同而改变自身行为的方式叫做重载；

除了加法运算符之外的其它运算符都不会发送重载，都是先直接把值转换为数值，然后进行计算。

### JavaScript提供9个算术运算符

    加法运算符（Addition）：x + y
    减法运算符（Subtraction）： x - y
    乘法运算符（Multiplication）： x * y
    除法运算符（Division）：x / y
    余数运算符（Remainder）：x % y
    自增运算符（Increment）：++x 或者 x++
    自减运算符（Decrement）：--x 或者 x--
    数值运算符（Convert to number）： +x
    负数值运算符（Negate）：-x


### 余数运算符

余数运算符的值的符号只与第一个值的正负号有关系

```javascript
1%2;    //1
1%-2;   //1
-1%2;   //-1
-1%-2;  //-1
```

### 自增和自减

有一个区别是位置相关，放在变量之后会先返回变量，然后再进行自增；放在变量之前，会先自增，然后再返回值；

```javascript
x = 1;  //1
x++;    //1
x;  //2
++x;    //3
x;  //3
```

- 数值运算符 -- 用于把任何运算子转换为数值；
- 负数值运算符 -- 和数值运算符类似，只不过得到负数；
- 他俩都不会改变原始值，而是得到一个新值。
- 连用俩个负数值运算符可以等同于数值运算符；

```javascript
var a = "1";
-a; //-1;
a;  //"1"
-(-a);  //1;
a;  //"1";
--a;    //0;
a;  //0;
```

### 赋值运算符

常见的赋值运算符就是`=`，此外还有`+=`、`-=`、`*=`、`/=`、`%=`；还有一些位操作符不常用；这些复合的赋值操作符都是先进行运算，然后将结果赋值左边的变量。

### 比较运算符

比较俩个值，然后返回一个布尔值，表示是否满足比较条件。
JS提供了8个比较运算符；`> , < , >=, <=, ==, ===, !=, !==`;

比较运算符可以比较各种类型的值，它的算法如下：
1. 如果是对象，则转换为原始类型，转换过程是先通过`valueOf`判断是否是原始类型，如果不是再通过`toString`转换为字符串。
2. 如果有一个是字符串，则全部转换为字符串。
3. 否则全部转换为数值。

如果转换过程中出现了`NaN`，则比较结果总是返回`false`，因为`NaN`和任何值比较都是返回`false`；

```javascript
1 > 'asd';  //false;
1 <= `asd`; //false;
```

#### 字符串的比较

因为JS的字符串比较是按照字典顺序比较的。所以会先比较第一个字符，有一下规则；
- 如果是小写字符，先比较第一个字符，字母表后面的字符大于前面的字符；
- 小写字符大于大写字符
- 因为汉字也是可以转换为码的，所以汉字也是可以比较大小的。`"大".charCodeAt()` => `22823`;

### 严格相等运算符

同一类型的原始类型的值相等，就返回true，`1 === 0x1 || 1 === 01`，虽然是10进制和16进制的值比较，但是因为值相同，所以是恒等的。

```javascript
1 === 0x1;  //true
1 === 01;   //true
+0 === -0;  //true
```

对于复合类型值的相等判断，是看复合类型引用的内存地址是不是一个，如果引用的是一个内存地址，那么就相等，否则就不等。

```javascript
[] === [];  //false;
({} === {});    //false;
(function(){} === function(){});    //false;
var a = [1,2];
var b = a;
a === b;    //true;
```

空对象的比较和空函数的比较，都放在括号内，是为了避免JavaScript引擎把行首的空对象解释成代码块，把行首的空函数解释成函数的定义。

`undefined` 和 `null` 是和自身严格相等的。所以俩个只声明未赋值的变量是恒等的。

```javascript
null === null;  //true;
undefined === undefined;    //true
var a;
var b;
a === b;    //true;
```

### 相等运算符

在比较相同类型的数据是和严格运算符相同。
在比较不同类型的数据是，会先将数据进行类型转换，然后再进行严格类型比较。

- 原始类型的值 -- 会先将原始类型的值转换为数值，再进行比较。
**对于相等运算符，原始类型的值比较会先把俩个值转换为数字进行比较。

```javascript
1 == true;  => 1 == 1;  true;
0 == false; => 0 == 0;  true;
'true' == true => NaN == 1; false;
'' == 0;    => 0 == 0;  true;
" " == 0;  => 0 == 0;   true;
```

- 对象与原始类型值比较； -- 对象会先转换为原始类型

```javascript
[1] == true     =>  1 == 1; //true;
['1'] == true   =>  1 ==1;  //true;
```

- `undefined` 和 `null`； -- 他俩和其它值比较是都是`false`，互相比较是`true`；

```javascript
false == null;  //false
false == undefined; //false;
0 == undefined; //false;
null == undefined; //true;
```

- 相等运算符 -- 会带来一些违反直觉的结果，注意只有不同类型的值才会进行类型转换，如果是相同类型的值，是进行严格相等的比较的。

```javascript
`0` == false;   =>  0 == 0; true;
' ' == '0';     =>  相同类型进行严格比较 false；
' ' == 0;       =>  0 == 0; true;
2 == true;      => 2 == 1;  false;
false == 'false' => 0 == NaN;   false;
false == undefined; => 0 == undefined;  false;
false == null;  false;  
//任何值和null和undefined比较都是false；
```

### 布尔运算符

布尔运算符有4个`&&, ||, !, ? : `;最后一个是三元运算符。
取反运算符可以转换数据为布尔值。只有`undefine, null, '', false, 0, NaN`这些值的布尔值为`false`。
`!!x` => `Boolean(x)`; 对一个值连续取反相当于直接求值的布尔值。

- 且运算符(&&) -- 短路；
使用短路的特性可以取代if条件语句。

- 和运算符(||) -- 短路 -- 主要用于函数的传入参数有默认值的情况

```javascript
    function cal(a){
        var a = a || 0;
        return a;
    }
```

- 三元运算符 -- 和`if else`功能类似，但是这个是个表达式，会有返回值，而`if else`是个语句，没有返回值，所以看情况。

### 其它运算符

- 圆括号 -- 作用是求值或者调用函数。
    -  将表达式放在圆括号里面会返回表达式的值；
    -  将对象放到圆括号里面会返回对象本身。
    -  将函数放到圆括号里面会返回函数本身，如果后面在跟圆括号，会调用函数。
    -  如果把语句放到圆括号里面会`(var a = 1;)`会报错，因为语句没有返回值。

- void -- **执行一个表达式**，然后不返回任何值，或者说返回undefined;

```html
<a href="javascript: void(window.open('http://www.a.com'))">click;</a>
<a href="javascript: void(console.log(true))">click22</a>
```

上面这个会执行打开窗口的命令，是在新页面打开，会执行函数，但是不会返回值。

- 逗号运算符 -- 用于对表达式求值，并且返回最后一个表达式的值。

```javascript
var x = 0;
var y = (x++,10);
x;  //1
y;  //10;
```

### 运算符的优先级

运算符是有优先级的，使用括号可以更改这种优先级。记住所有的优先级是不可能也没必要的，总是使用圆括号来表现优先级。

### 左结合与右结合

大多数运算都是从左到右的，即左结合，`a + b + c`;
右结合的使用场景是：赋值和三元运算符；

```javascript
x = a + b + c;
y = a ? b : c ? d: e ? f: g; =>
y = a ? b : (c ? d: (e ? f: g));
```


